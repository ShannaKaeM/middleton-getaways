(()=>{"use strict";new class{constructor(){this.elements=document.querySelectorAll("[data-gb-is-sticky]"),this.lastScrollY=window.scrollY,this.rafId=null,this.wpAdminBarOffset=0,this.isTicking=!1,this.lastHiddenScrollY=new Map,this.lastTriggerScrollY=new Map,this.lastScrollUpY=new Map,this.initializedElements=new Set,this.mediaQueryHandlers=new Map,this.originalStyles=new Map,this.elementMetadata=new Map,this.resizeHandler=()=>this.handleResize(),this.scrollHandler=()=>this.requestTick(),this.init()}init(){const t=document.querySelector("#wpadminbar");if(t){const e=new MutationObserver((()=>{this.updateAdminBarOffset(),this.requestTick()}));e.observe(t,{attributes:!0,childList:!0,subtree:!0}),this.elementMetadata.set("adminBarObserver",e)}this.updateAdminBarOffset();const e=window.scrollY;this.elements.forEach((t=>{const i="scroll-up"===t.dataset.gbStickyHeaderType,s=t.style.position,l=t.style.top,a=t.style.zIndex,n=t.style.left,r=t.style.right,d=t.style.width,o=t.style.willChange;this.originalStyles.set(t,{originalPosition:s,originalTop:l,originalZIndex:a,originalLeft:n,originalRight:r,originalWidth:d,originalWillChange:o}),this.elementMetadata.set(t,{isScrollUpType:i,placeholder:null,wasSticking:!1});const h=t.dataset.gbStickyBreakpoint;let c=!0;if(h)try{const e=window.matchMedia(`(${h.trim()})`);c=e.matches;const i=()=>{this.handleMediaQueryChange(t,e)};e.addEventListener("change",i),this.mediaQueryHandlers.set(t,{mql:e,handler:i})}catch(t){c=!1}c&&(this.initializeElement(t,e),this.initializedElements.add(t))})),window.addEventListener("scroll",this.scrollHandler,{passive:!0}),window.addEventListener("resize",this.resizeHandler,{passive:!0}),this.updateHeaderClasses(this.lastScrollY)}updateAdminBarOffset(){const t=document.querySelector("#wpadminbar");t&&"fixed"===getComputedStyle(t).position&&t.offsetHeight>0?this.wpAdminBarOffset=t.offsetHeight:this.wpAdminBarOffset=0}initializeElement(t,e){this.updateAdminBarOffset();const i=this.elementMetadata.get(t),{isScrollUpType:s}=i,l=getComputedStyle(t),a=t.offsetHeight,n=parseFloat(l.marginBottom)||0,r=a+n;let d=i.placeholder;d&&d.parentNode||(d=document.createElement("div"),d.classList.add("gb-sticky-placeholder"),d.style.boxSizing=l.boxSizing,t.parentNode.insertBefore(d,t.nextSibling),i.placeholder=d),d.style.height=`${r}px`,d.style.display="none";const o=t.style.position,h=t.style.width,c=t.style.maxWidth;t.style.position="static",t.style.width="",t.style.maxWidth="",t.offsetHeight;const g=t.getBoundingClientRect(),p=g.top+window.scrollY,y=g.width;t.style.position=o,t.style.width=h,t.style.maxWidth=c;const m=t.closest('[style*="max-width"], [style*="width"], .container, .wrapper')||document.body,S=m.getBoundingClientRect(),f=getComputedStyle(m),w=parseFloat(f.paddingLeft)||0,u=parseFloat(f.borderLeftWidth)||0,Y=parseFloat(f.paddingRight)||0,k=parseFloat(f.borderRightWidth)||0,b=g.left-(S.left+w+u),v=S.width-(w+Y+u+k),H=Math.abs(y-v)<2||y>=window.innerWidth,T=Math.max(0,p-this.wpAdminBarOffset),L=e>T;this.elementMetadata.set(t,{...i,triggerPoint:T,wasSticking:L,naturalLeft:b,naturalWidth:y,isFullWidth:H,container:m,naturalTop:p,originalHeight:a,marginBottom:n}),this.applyStickyStyles(t,L),s&&L?(this.lastTriggerScrollY.set(t,e),e>T?(t.classList.add("gb-is-sticky-hidden"),this.lastHiddenScrollY.set(t,e)):t.classList.remove("gb-is-sticky-hidden")):s&&!L&&(t.classList.remove("gb-is-sticky-hidden"),this.lastHiddenScrollY.delete(t),this.lastTriggerScrollY.delete(t),this.lastScrollUpY.delete(t))}applyStickyStyles(t,e){const i=this.elementMetadata.get(t),{placeholder:s,naturalLeft:l,naturalWidth:a,container:n,originalHeight:r,marginBottom:d,isFullWidth:o}=i;if(!s||!n||void 0===r||void 0===d)return;const{originalPosition:h,originalTop:c,originalZIndex:g,originalLeft:p,originalRight:y,originalWidth:m,originalWillChange:S}=this.originalStyles.get(t);if(e){const e=n.getBoundingClientRect(),i=getComputedStyle(n),h=parseFloat(i.paddingLeft)||0,c=parseFloat(i.borderLeftWidth)||0;let p,y,m;o?(y="0px",m="0px",p="auto"):(y=`${e.left+h+c+l}px`,p=`${a}px`,m=""),s.style.display="block",s.style.height=`${r+d}px`,t.style.position="fixed",t.style.top=`${this.wpAdminBarOffset}px`,t.style.zIndex="auto"===g||""===g?"100":g,t.classList.add("gb-is-sticky"),t.style.left=y,t.style.right=m,t.style.width=p}else t.classList.remove("gb-is-sticky","gb-is-sticky-hidden"),t.style.position=h||"",t.style.top=c||"",t.style.zIndex=g||"",t.style.left=p||"",t.style.right=y||"",t.style.width=m||"",t.style.willChange=S||"",s.style.display="none"}handleMediaQueryChange(t,e){const i=this.elementMetadata.get(t),{originalPosition:s,originalTop:l,originalZIndex:a,originalLeft:n,originalRight:r,originalWidth:d,originalWillChange:o}=this.originalStyles.get(t),{placeholder:h}=i;if(e.matches&&!this.initializedElements.has(t))this.initializeElement(t,window.scrollY),this.initializedElements.add(t);else if(!e.matches&&this.initializedElements.has(t)){t.style.position=s||"",t.style.top=l||"",t.style.zIndex=a||"",t.style.left=n||"",t.style.right=r||"",t.style.width=d||"",t.style.willChange=o||"",t.classList.remove("gb-is-sticky","gb-is-sticky-hidden"),h&&(h.style.display="none"),h&&h.parentNode&&h.parentNode.removeChild(h),this.lastHiddenScrollY.delete(t),this.lastTriggerScrollY.delete(t),this.lastScrollUpY.delete(t),this.initializedElements.delete(t);const e=i.isScrollUpType;this.elementMetadata.set(t,{isScrollUpType:e,placeholder:null,wasSticking:!1})}}requestTick(){this.isTicking||(this.rafId=requestAnimationFrame((()=>this.update())),this.isTicking=!0)}update(){this.updateAdminBarOffset(),this.updateHeaderClasses(window.scrollY),this.isTicking=!1}handleResize(){this.updateAdminBarOffset(),this.elements.forEach((t=>{this.initializedElements.has(t)&&this.initializeElement(t,window.scrollY)})),this.requestTick()}updateHeaderClasses(t){if(0===this.initializedElements.size)return void(this.lastScrollY=t);const e=t>this.lastScrollY?"down":"up";this.elements.forEach((i=>{if(!this.initializedElements.has(i))return;const s=this.elementMetadata.get(i),{triggerPoint:l,isScrollUpType:a,wasSticking:n,placeholder:r,originalHeight:d,marginBottom:o}=s;let h=i.classList.contains("gb-is-sticky-hidden");const c=t>l;c!==n&&(this.applyStickyStyles(i,c),this.elementMetadata.get(i).wasSticking=c,c?a&&(i.classList.remove("gb-is-sticky-hidden"),h=!1,this.lastHiddenScrollY.delete(i),this.lastTriggerScrollY.set(i,t),this.lastScrollUpY.delete(i)):(h&&(i.classList.remove("gb-is-sticky-hidden"),h=!1),this.lastHiddenScrollY.delete(i),this.lastTriggerScrollY.delete(i),this.lastScrollUpY.delete(i))),r&&void 0!==d&&void 0!==o&&r.style.height!==`${d+o}px`&&(r.style.height=`${d+o}px`),a&&c&&("down"===e?(this.lastScrollUpY.has(i)&&this.lastScrollUpY.delete(i),h||(this.lastTriggerScrollY.has(i)||this.lastTriggerScrollY.set(i,t),t-this.lastTriggerScrollY.get(i)>=100&&(i.classList.add("gb-is-sticky-hidden"),this.lastHiddenScrollY.set(i,t),this.lastTriggerScrollY.delete(i),h=!0))):"up"===e&&h&&this.lastHiddenScrollY.has(i)&&(this.lastScrollUpY.has(i)||this.lastScrollUpY.set(i,t),this.lastScrollUpY.get(i)-t>=50&&(i.classList.remove("gb-is-sticky-hidden"),this.lastHiddenScrollY.delete(i),this.lastTriggerScrollY.set(i,t),this.lastScrollUpY.delete(i),h=!1)))})),this.lastScrollY=t}destroy(){this.elements.forEach((t=>{const{originalPosition:e,originalTop:i,originalZIndex:s,originalLeft:l,originalRight:a,originalWidth:n,originalWillChange:r}=this.originalStyles.get(t)||{},d=this.elementMetadata.get(t)||{},{placeholder:o}=d;t.style.position=e||"",t.style.top=i||"",t.style.zIndex=s||"",t.style.left=l||"",t.style.right=a||"",t.style.width=n||"",t.style.willChange=r||"",t.classList.remove("gb-is-sticky","gb-is-sticky-hidden"),o&&(o.style.display="none"),o&&o.parentNode&&o.parentNode.removeChild(o),this.lastHiddenScrollY.delete(t),this.lastTriggerScrollY.delete(t),this.lastScrollUpY.delete(t),this.initializedElements.delete(t),this.elementMetadata.delete(t)})),window.removeEventListener("scroll",this.scrollHandler,{passive:!0}),window.removeEventListener("resize",this.resizeHandler,{passive:!0}),cancelAnimationFrame(this.rafId),this.mediaQueryHandlers.forEach((({mql:t,handler:e})=>t.removeEventListener("change",e))),this.mediaQueryHandlers.clear(),this.originalStyles.clear();const t=this.elementMetadata.get("adminBarObserver");t&&t.disconnect(),this.elementMetadata.clear()}}})();