{# Typography Editor - Load tokens from JSON #}
{% set typography_tokens = load_primitive('typography') %}

<div class="primitive-editor typography-editor">
    <div class="primitive-header">
        <h1>Typography Editor</h1>
        <div class="primitive-actions">
            <button id="save-to-json" class="btn btn-primary">Save</button>
            <button id="sync-to-theme-json" class="btn btn-secondary">Save to Theme</button>
            <button id="reset-typography" class="btn btn-ghost">Reset</button>
            <button id="export-typography" class="btn btn-ghost">Export</button>
        </div>
    </div>

    <div class="primitive-content">
        <!-- Font Sizes -->
        <section class="primitive-section">
            <h2>Font Sizes</h2>
            <div class="typography-grid">
                {% for slug, size in typography_tokens.font_sizes %}
                <div class="typography-card">
                    <div class="preview preview-{{ slug }}">
                        <p style="font-size: {{ size }};">Text</p>
                    </div>
                    <div class="typography-controls">
                        <label style="font-weight: 600;">{{ slug|upper }}</label>
                        <div class="control-group">
                            <input type="number" 
                                   class="font-size-input" 
                                   data-slug="{{ slug }}" 
                                   value="{{ size|replace({'rem': '', 'px': '', 'em': ''}) }}"
                                   step="0.1">
                            <select class="font-size-unit" data-slug="{{ slug }}">
                                <option value="rem" {% if 'rem' in size %}selected{% endif %}>rem</option>
                                <option value="px" {% if 'px' in size %}selected{% endif %}>px</option>
                                <option value="em" {% if 'em' in size %}selected{% endif %}>em</option>
                            </select>
                        </div>
                        <span class="value-display font-size-value" data-slug="{{ slug }}">{{ size }}</span>
                        <button class="copy-btn" data-copy="{{ size }}">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                            </svg>
                        </button>
                    </div>
                </div>
                {% endfor %}
            </div>
        </section>

        <!-- Font Families -->
        <section class="primitive-section">
            <h2>Font Families</h2>
            <div class="typography-grid">
                {% for slug, family in typography_tokens.font_families %}
                <div class="typography-card">
                    <div class="preview preview-family-{{ slug }}">
                        <p style="font-family: {{ family }};">{{ family }}</p>
                    </div>
                    <div class="typography-controls">
                        <label>FONT STACK</label>
                        <textarea class="font-stack-display" readonly>{{ family }}</textarea>
                        <p class="font-name" style="font-family: Montserrat, sans-serif;">{{ family|split(',')[0] }}</p>
                        <button class="copy-btn" data-copy="{{ family }}">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                            </svg>
                        </button>
                    </div>
                </div>
                {% endfor %}
            </div>
        </section>

        <!-- Font Weights -->
        <section class="primitive-section">
            <h2>Font Weights</h2>
            <div class="typography-grid">
                {% for slug, weight in typography_tokens.font_weights %}
                <div class="typography-card">
                    <div class="preview preview-weight-{{ slug }}">
                        <p style="font-weight: {{ weight }};">
                            <strong style="font-weight: 600;">{{ slug|capitalize }}</strong>
                        </p>
                    </div>
                    <div class="typography-controls">
                        <label>WEIGHT</label>
                        <input type="range" 
                               class="font-weight-input" 
                               data-slug="{{ slug }}" 
                               value="{{ weight }}"
                               min="100" 
                               max="900" 
                               step="100">
                        <span class="value-display font-weight-value" data-slug="{{ slug }}">{{ weight }}</span>
                        <button class="copy-btn" data-copy="{{ weight }}">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                            </svg>
                        </button>
                    </div>
                </div>
                {% endfor %}
            </div>
        </section>

        <!-- Line Heights -->
        <section class="primitive-section">
            <h2>Line Heights</h2>
            <div class="typography-grid">
                {% for slug, height in typography_tokens.line_heights %}
                <div class="typography-card">
                    <div class="preview preview-line-height-{{ slug }}">
                        <p style="line-height: {{ height }};">
                            <strong style="font-weight: 600;">{{ slug|capitalize }}</strong>
                        </p>
                    </div>
                    <div class="typography-controls">
                        <label>LINE HEIGHT</label>
                        <input type="number" 
                               class="line-height-input" 
                               data-slug="{{ slug }}" 
                               value="{{ height }}"
                               min="1" 
                               max="3" 
                               step="0.1">
                        <span class="value-display line-height-value" data-slug="{{ slug }}">{{ height }}</span>
                        <button class="copy-btn" data-copy="{{ height }}">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                            </svg>
                        </button>
                    </div>
                </div>
                {% endfor %}
            </div>
        </section>

        <!-- Letter Spacing -->
        <section class="primitive-section">
            <h2>Letter Spacing</h2>
            <div class="typography-grid">
                {% for slug, spacing in typography_tokens.letter_spacings %}
                <div class="typography-card">
                    <div class="preview preview-letter-spacing-{{ slug }}">
                        <p style="letter-spacing: {{ spacing }}; font-weight: 600;">{{ slug|capitalize }}</p>
                    </div>
                    <div class="typography-controls">
                        <label>SPACING</label>
                        <input type="number" 
                               class="letter-spacing-input" 
                               data-slug="{{ slug }}" 
                               value="{{ spacing|replace({'em': ''}) }}"
                               min="-0.1" 
                               max="0.5" 
                               step="0.01">
                        <span class="value-display letter-spacing-value" data-slug="{{ slug }}">{{ spacing }}</span>
                        <button class="copy-btn" data-copy="{{ spacing }}">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                            </svg>
                        </button>
                    </div>
                </div>
                {% endfor %}
            </div>
        </section>

        <!-- Text Transform -->
        <section class="primitive-section">
            <h2>Text Transform</h2>
            <div class="typography-grid">
                {% for slug, transform in typography_tokens.text_transforms %}
                <div class="typography-card">
                    <div class="preview preview-text-transform-{{ slug }}">
                        <p style="text-transform: {{ transform }}; font-weight: 600;">{{ slug }}</p>
                    </div>
                    <div class="typography-controls">
                        <label>TRANSFORM</label>
                        <select class="text-transform-input" data-slug="{{ slug }}">
                            <option value="none" {% if transform == 'none' %}selected{% endif %}>None</option>
                            <option value="uppercase" {% if transform == 'uppercase' %}selected{% endif %}>Uppercase</option>
                            <option value="lowercase" {% if transform == 'lowercase' %}selected{% endif %}>Lowercase</option>
                            <option value="capitalize" {% if transform == 'capitalize' %}selected{% endif %}>Capitalize</option>
                        </select>
                        <span class="value-display text-transform-value" data-slug="{{ slug }}">{{ transform }}</span>
                        <button class="copy-btn" data-copy="{{ transform }}">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                            </svg>
                        </button>
                    </div>
                </div>
                {% endfor %}
            </div>
        </section>
    </div>
</div>

<script>
// Pass data to JavaScript
window.primitiveTypography = {
    ajaxUrl: '{{ function('admin_url', 'admin-ajax.php') }}',
    nonce: '{{ function('wp_create_nonce', 'mi_design_book_nonce') }}',
    canEdit: {{ function('current_user_can', 'edit_theme_options') ? 'true' : 'false' }}
};
</script>
